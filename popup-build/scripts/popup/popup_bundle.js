(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const c of t)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function n(t){const c={};return t.integrity&&(c.integrity=t.integrity),t.referrerPolicy&&(c.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?c.credentials="include":t.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function a(t){if(t.ep)return;t.ep=!0;const c=n(t);fetch(t.href,c)}})();const s=e=>document.getElementById(e),V=e=>document.getElementsByClassName(e)[0],h=e=>{e.classList.add("forceHoverEffect")},w=e=>{e.classList.remove("forceHoverEffect")},r=(e,o)=>{chrome.storage.local.set({[e]:o})},b=e=>new Promise(o=>{chrome.storage.local.get(e,n=>{o(n)})}),D=()=>{chrome.action.setIcon({path:"/images/browser/icon128_disabled.png"})},x=()=>{chrome.action.setIcon({path:"/images/browser/icon128.png"})};s("appEnableCheckbox");const z=s("appEnableCheckboxBtn"),M=V("appEnableCheckboxBtn_inner");s("snowflakesCountPlate");s("snowflakesCountInput");s("incSnowflakesCountBtn");s("decSnowflakesCountBtn");s("ztopCheckbox");s("ztopCheckboxBtn");s("staticColorPlate");s("snowColorStaticInput");s("snowColorStaticBtn");s("dynamicColorPlate");s("snowColorDynamicInput");s("snowColorDynamicBtn");const g=s("advancedSettings");s("popupEnableChangeBgEffect");s("donateBtn");const A=()=>{g.classList.add("open")},O=()=>{g.classList.remove("open")},T=()=>{popupEnableChangeBgEffect.classList.add("grow")},Z=()=>{popupEnableChangeBgEffect.classList.remove("grow")},H=()=>{T(),A()},N=()=>{Z(),O()},v=e=>{e?(H(),x()):(N(),D())},$=()=>{appEnableCheckboxBtn.classList.add("switcher-enable")},F=()=>{appEnableCheckboxBtn.classList.remove("switcher-enable")},W=()=>{advancedSettings.classList.add("colorize")},_=()=>{advancedSettings.classList.remove("colorize")},G=()=>{$(),W(),r("snowfallEnable",!0)},R=()=>{F(),_(),r("snowfallEnable",!1)},S=e=>{if(typeof e!="boolean")throw`incorrect new app state - ${e}`;e?G():R()},U=()=>{donateBtn.classList.add("show")},q=()=>{donateBtn.classList.remove("show")},E=e=>{e?U():q()},K=({target:e})=>{v(e.checked),S(e.checked),E(e.checked)};appEnableCheckbox.addEventListener("change",K);document.addEventListener("contextmenu",e=>{e.preventDefault()});const j=e=>{r("snowfallColor",e),I(e)};let y=null;const J=()=>y,B=e=>{if(e!=="static"&&e!=="dynamic")throw`incorrect mode type - ${e}`;y=e,r("snowfallColorMode",e)},m=()=>{B("static"),Q(),ee(),te(),w(dynamicColorPlate),h(staticColorPlate)},L=()=>{B("dynamic"),X(),Y(),oe(),w(staticColorPlate),h(dynamicColorPlate)},Q=()=>{snowColorStaticBtn.classList.add("colorize")},X=()=>{snowColorStaticBtn.classList.remove("colorize")},I=e=>{document.body.style.setProperty("--userChosenColor",e)},Y=()=>{snowColorDynamicBtn.classList.add("colorize")},ee=()=>{snowColorDynamicBtn.classList.remove("colorize")},oe=()=>{snowColorDynamicInput.checked=!0},te=()=>{snowColorDynamicInput.checked=!1},ne=({target:e})=>{e.checked?L():m()};snowColorDynamicInput.addEventListener("change",ne);const se=({target:e})=>{const o=e.value;j(o),J()==="dynamic"&&m()};snowColorStaticInput.addEventListener("input",se);const ce=()=>{h(snowflakesCountPlate)},ae=()=>{w(snowflakesCountPlate)};snowflakesCountInput.addEventListener("focus",ce);snowflakesCountInput.addEventListener("blur",ae);const le=()=>{ztopCheckboxBtn.classList.add("enable")},re=()=>{ztopCheckboxBtn.classList.remove("enable")},P=e=>{e?le():re()},ie=({target:e})=>{r("snowfallZtop",e.checked),P(e.checked)};ztopCheckbox.addEventListener("change",ie);window.addEventListener("load",()=>{setTimeout(()=>{z.style.transition="var(--transition)",M.style.transition="var(--transition)"},50)},{once:!0});const l={enable:!0,count:100,color:"#cd4c4c",onTop:!1,dynamicColor:!1};class ue{constructor(o,n=0,a=()=>{},t=()=>{}){this.prevValue=String(n),this.checker=o,this.successCallback=a,this.unsuccessCallback=t}handleEvent(o){const n=o.target.value;if(this.checker(n))this.updatePrevValue(n),this.successCallback(n);else{const t=o.target.selectionStart;this.restore(o.target,n,t),this.unsuccessCallback()}}restore(o,n,a){this.restorePrevValue(o),this.restorePrevCaretPos(o,n,a)}restorePrevValue(o){o.value=this.prevValue}restorePrevCaretPos(o,n,a){const t=n.length,c=a-(t-this.prevValue.length);o.setSelectionRange(c,c)}updatePrevValue(o){this.prevValue=o}getPrevValue(){return this.prevValue}dispatchInput(o){o.target.value=o.newValue,this.handleEvent(o)}}const C=1,p=1e3,de=e=>e!=="",Ce=e=>e>=C,pe=e=>e<p,fe=/^\d+$/,he=e=>fe.test(e),we=e=>de(e)&&he(e)&&Ce(e)&&pe(e);let f=null;const u=e=>{const n=k()+e;f.dispatchInput({target:snowflakesCountInput,newValue:n})},k=()=>Number(snowflakesCountInput.value),me=e=>{r("snowfallCount",e)},ke=async()=>{{const{snowfallCount:e}=await b({snowfallCount:l.count});f=new ue(we,e,me),snowflakesCountInput.addEventListener("input",f)}};ke();const i=10,be=()=>{const e=k(),o=(e-i<=C?e-C:i)*-1;u(o)},ge=()=>{const e=k(),o=e+i>p?p-(e+1):i;u(o)},ve=({deltaY:e})=>{e<0?ge():e>0&&be()};snowflakesCountInput.addEventListener("wheel",ve);const Se=()=>{u(1)},Ee=()=>{u(-1)};incSnowflakesCountBtn.addEventListener("click",Se);decSnowflakesCountBtn.addEventListener("click",Ee);const ye=async()=>{let e;e=await b({snowfallEnable:l.enable,snowfallCount:l.count,snowfallColor:l.color,snowfallZtop:l.onTop,snowfallColorMode:l.dynamicColor}),appEnableCheckbox.checked=e.snowfallEnable,snowflakesCountInput.value=e.snowfallCount,snowColorStaticInput.value=e.snowfallColor,ztopCheckbox.checked=e.snowfallZtop,v(e.snowfallEnable),S(e.snowfallEnable),E(e.snowfallEnable),e.snowfallColorMode==="static"?m():L(),I(e.snowfallColor),P(e.snowfallZtop)};ye();
